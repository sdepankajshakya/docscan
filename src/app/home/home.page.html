<ion-tabs>
  <ion-tab tab="home">
    <div class="ion-page">
      <ion-header class="ion-no-border">
        <ion-toolbar color="primary">
          <ion-title>
            <div class="branding-container">
              <img src="assets/icon/icon.png" class="header-logo" />
              <span>DocScan</span>
            </div>
          </ion-title>
        </ion-toolbar>
      </ion-header>

      <ion-content>
        <ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
          <ion-refresher-content></ion-refresher-content>
        </ion-refresher>

        <div class="search-container">
          <div class="search-box">
            <ion-icon name="search-outline"></ion-icon>
            <input type="text" placeholder="Search documents..." [value]="searchQuery" (input)="search($event)" />
            @if (searchQuery) {
              <ion-icon name="close-circle" (click)="searchQuery = ''" class="clear-icon"></ion-icon>
            }
          </div>
          <input type="file" accept="image/*,application/pdf" #fileInput (change)="handleFileSelect($event)" style="display: none;">
        </div>

        <div class="content-grid">
          @if (filteredDocuments.length === 0) {
            <div class="empty-state">
              <div class="empty-icon-container">
                <ion-icon name="document-text-outline"></ion-icon>
              </div>
              <h3>No Documents Found</h3>
              @if (!searchQuery) {
                <p>Tap the camera button to scan your first document.</p>
              }
              @if (searchQuery) {
                <p>Try adjusting your search terms.</p>
              }
            </div>
          }

          <ion-grid>
            <ion-row>
              @for (doc of filteredDocuments; track $index) {
                <ion-col size="4" size-sm="3" size-md="2">
                  <div class="doc-card" (click)="openDocument(doc)">
                    <div class="doc-preview">
                      @if (doc.thumbnail) {
                        <img [src]="getThumbnailUrl(doc)" alt="doc thumbnail" class="doc-thumb-img" />
                      } @else if (doc.type === 'pdf') {
                        <ion-icon name="document-outline" color="primary"></ion-icon>
                      } @else {
                        <ion-icon name="image-outline" color="primary"></ion-icon>
                      }
                      
                      <div class="more-options" (click)="$event.stopPropagation(); presentDocumentOptions(doc)">
                        <ion-icon name="ellipsis-vertical"></ion-icon>
                      </div>
                    </div>
                    <span class="doc-name">{{ doc.name }}</span>
                    <span class="doc-date">{{ doc.date }}</span>
                  </div>
                </ion-col>
              }
            </ion-row>
          </ion-grid>
        </div>
      </ion-content>
    </div>
  </ion-tab>

  <ion-tab-bar slot="bottom">
    <ion-tab-button tab="home">
      <ion-icon name="home-outline"></ion-icon>
      <span>Home</span>
    </ion-tab-button>
    
    <ion-tab-button tab="camera" (click)="takePhoto()">
      <ion-icon name="camera"></ion-icon>
      <span>Scan</span>
    </ion-tab-button>
    
    <ion-tab-button tab="files" (click)="openFilePicker()">
      <ion-icon name="folder-open-outline"></ion-icon>
      <span>Files</span>
    </ion-tab-button>
  </ion-tab-bar>
</ion-tabs>